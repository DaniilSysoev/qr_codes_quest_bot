from django.shortcuts import HttpResponse
import telebot
from django.conf import settings
from .models import User, Question, Game
import os
from django.views.decorators.csrf import csrf_exempt


bot = telebot.TeleBot(settings.BOT_TOKEN)
# https://api.telegram.org/bot6180293008:AAGqnW0xsH8jfx9HqZjAp24WR-H7Kbb-j2k/setWebhook?url=https://1452-217-151-229-99.ngrok-free.app
# https://api.telegram.org/bot5813570276:AAHVVgjcZZzmYr0Vrb-X9DXq-WHsrsXqLdo/setWebhook?url=https://ec6c-217-151-229-99.ngrok-free.app

@csrf_exempt
def index(request):
    if request.method == "POST":
        update = telebot.types.Update.de_json(request.body.decode('utf-8'))
        bot.process_new_updates([update])

    return HttpResponse('<h1>–¢—ã –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è!</h1>')


@bot.message_handler(commands=['start'])
def start(message: telebot.types.Message):
    if User.objects.filter(tg_id=message.from_user.id).exists():
        user = User.objects.get(tg_id=message.from_user.id)
        #–µ—Å–ª–∏ stage <=12, —Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
        if user.stage < 12:
            keyboard = telebot.types.InlineKeyboardMarkup()
            key1 = telebot.types.InlineKeyboardButton(text='–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å', callback_data='–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å')
            keyboard.add(key1)
            bot.send_message(message.chat.id, f"""–ö–∞–∂–µ—Ç—Å—è, –º—ã —Å —Ç–æ–±–æ–π —É–∂–µ –∑–Ω–∞–∫–æ–º—ã, –∏ —Ç—ã —É–∂–µ –Ω–∞—á–∞–ª –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –º–æ–π –∫–≤–µ—Å—Ç
–¢–≤–æ–π —Å—á—ë—Ç –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç: {user.score}""", reply_markup=keyboard)
            return
        bot.send_message(message.chat.id, f"""–Ø –≤–∏–∂—É, —á—Ç–æ —Ç—ã —É–∂–µ –∑–∞–≤–µ—Ä—à–∏–ª –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –º–æ–µ–≥–æ –∫–≤–µ—Å—Ç–∞.
–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–π—Ç–∏ –µ–≥–æ –∑–∞–Ω–æ–≤–æ –Ω–µ—Ç
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}""")
        return
    else:
        User.objects.create(tg_id=message.from_user.id, start=Game.objects.all().values('start_question')[0]['start_question'], stage=0, wave=Game.objects.all().values('wave')[0]['wave'])
        bot.send_message(message.chat.id, """–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é —Ç–µ–±—è, –¥–æ—Ä–æ–≥–æ–π —Å—Ç—É–¥–µ–Ω—Ç!
–Ø ‚Äî AI-–Ω–∞–≤–∏–≥–∞—Ç–æ—Ä, –∏ —è —Ä–∞–¥, —á—Ç–æ —Ç–µ–±–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞. –Ø –ø–æ–º–æ–≥—É —Ç–µ–±–µ –≤ —ç—Ç–æ–º!

–¢–µ–±–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤. –ï—Å–ª–∏ –±—ã—Ç—å —Ç–æ—á–Ω—ã–º, —Ç–æ –∏—Ö –±—É–¥–µ—Ç 12.
–ù–æ –Ω–µ —Ä–∞—Å—Å–ª–∞–±–ª—è–π—Å—è! –Ø –Ω–µ –±—É–¥—É —Ç–µ–±–µ —Å—Ä–∞–∑—É –∑–∞–¥–∞–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã, –∞ —Ç—ã –¥–æ–ª–∂–µ–Ω –±—É–¥–µ—à—å –Ω–∞–π—Ç–∏ –∏—Ö —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. –Ø –ª–∏—à—å –±—É–¥—É –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Ç–µ–±–µ –º–µ—Å—Ç–æ, –∫—É–¥–∞ —Ç–µ–±–µ –∏–¥—Ç–∏.
–ü–æ—Å–ª–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ —è –±—É–¥—É –∂–¥–∞—Ç—å –æ—Ç —Ç–µ–±—è –æ—Ç–≤–µ—Ç.
–Ø –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ –≤—ã, –ª—é–¥–∏, —Å–∫–ª–æ–Ω–Ω—ã –¥–µ–ª–∞—Ç—å –æ—à–∏–±–∫–∏, –ø–æ—ç—Ç–æ–º—É —É —Ç–µ–±—è –±—É–¥–µ—Ç —Ü–µ–ª—ã—Ö –¥–≤–µ –ø–æ–ø—ã—Ç–∫–∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å)

–ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏:
‚ñ™Ô∏è–ï—Å–ª–∏ —Ç—ã –≤–æ –≤—Ä–µ–º—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –º–æ–µ–≥–æ –∫–≤–µ—Å—Ç–∞ –∑–∞—Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å —Å–≤–æ–∏ —Ç–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, —Ç–æ —Ç–µ–±–µ –¥–ª—è —ç—Ç–æ–≥–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–°—á—ë—Ç"
‚ñ™Ô∏è–ï—Å–ª–∏ –Ω–∞ –∫–∞–∫–æ–π-—Ç–æ –≤–æ–ø—Ä–æ—Å —Ç—ã –Ω–µ –∑–∞—Ö–æ—á–µ—à—å –æ—Ç–≤–µ—á–∞—Ç—å, —Ç–æ —Ç–µ–±–µ –¥–ª—è —ç—Ç–æ–≥–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"
‚ñ™Ô∏è–ï—Å–ª–∏ —Ç—ã –∑–∞—Ö–æ—á–µ—à—å –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –º–æ–µ–≥–æ –∫–≤–µ—Å—Ç–∞, —Ç–æ –¥–ª—è —ç—Ç–æ–≥–æ —Ç–µ–±—è –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤–≤–µ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—É /stop

–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –∫–≤–µ—Å—Ç–∞ —è –±—É–¥—É —Å—á–∏—Ç–∞—Ç—å —É—Å–ø–µ—à–Ω—ã–º, –µ—Å–ª–∏ —Ç—ã –≤–µ—Ä–Ω–æ –æ—Ç–≤–µ—Ç–∏—à—å –Ω–∞ 10 –º–æ–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–∑ 12.
–ó–∞ —É—Å–ø–µ—à–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —Ç—ã –º–æ–∂–µ—à—å –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–∑, –ø–æ—ç—Ç–æ–º—É –ø–æ—Ç–æ—Ä–æ–ø–∏—Å—å, –≤–µ–¥—å –∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ!""")
    game = Game.objects.all()[0]
    game.start_question = game.start_question - 1 if game.start_question > 1 else 12
    game.save()
    bot.send_message(message.chat.id, """–Ø –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª—Å—è, —Ç–µ–ø–µ—Ä—å —Ç–≤–æ—è –æ—á–µ—Ä–µ–¥—å ü´µ
–ù–∞–ø–∏—à–∏ —Å–≤–æ—ë –∏–º—è""")
    bot.register_next_step_handler(message, get_name)


def get_name(message: telebot.types.Message):
    user = User.objects.get(tg_id=message.from_user.id)
    user.name = message.text
    user.save()
    bot.send_message(message.chat.id, """–¢–µ–ø–µ—Ä—å —è –∑–Ω–∞—é –æ —Ç–µ–±–µ —á—É—Ç—å –±–æ–ª—å—à–µ, –Ω–æ –º–Ω–µ –º–∞–ª–æ üôÉ
–ù–∞–ø–∏—à–∏ —Å–≤–æ—é —Ñ–∞–º–∏–ª–∏—é""")
    bot.register_next_step_handler(message, get_surname)


def get_surname(message: telebot.types.Message):
    user = User.objects.get(tg_id=message.from_user.id)
    user.surname = message.text
    user.save()
    flag = True
    keyboard = telebot.types.InlineKeyboardMarkup()
    if flag:
        key1 = telebot.types.InlineKeyboardButton(text='–ú–ò–≠–ú', callback_data='–ú–ò–≠–ú')
        keyboard.add(key1)
        key2 = telebot.types.InlineKeyboardButton(text='–ü–æ–∫—Ä–æ–≤–∫–∞', callback_data='–ü–æ–∫—Ä–æ–≤–∫–∞')
        keyboard.add(key2)
        bot.send_message(message.chat.id, text="""–ù—É –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ, —á—Ç–æ —è —Ö–æ—á—É –æ —Ç–µ–±–µ –∑–Ω–∞—Ç—å...
–í—ã–±–µ—Ä–∏ –∫–æ—Ä–ø—É—Å, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ç—ã —Å–µ–π—á–∞—Å –Ω–∞—Ö–æ–¥–∏—à—å—Å—è""", reply_markup=keyboard)
    else:
        user.campus = '–°—Ç–∞—Ä–∞—è –ë–∞—Å–º–∞–Ω–Ω–∞—è'
        user.save()
        keyboard = telebot.types.InlineKeyboardMarkup()
        key2 = telebot.types.InlineKeyboardButton(text='–ù–∞—á–∞—Ç—å', callback_data='–ù–∞—á–∞—Ç—å')
        keyboard.add(key2)
        bot.send_message(message.chat.id, f"""–ò—Ç–∞–∫, –¥–∞–≤–∞–π –æ–±—ä–µ–¥–∏–Ω–∏–º —Ç–æ, —á—Ç–æ —è –æ —Ç–µ–±–µ —É–∑–Ω–∞–ª
–¢–µ–±—è –∑–æ–≤—É—Ç {user.name}
–¢–≤–æ—è —Ñ–∞–º–∏–ª–∏—è {user.surname}

–¢—ã –≥–æ—Ç–æ–≤ –ø—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—é –º–æ–µ–≥–æ –∫–≤–µ—Å—Ç–∞?""", reply_markup=keyboard)


@bot.callback_query_handler(func=lambda call: True)
def callback_worker(call: telebot.types.CallbackQuery):
    if call.data == '–ú–ò–≠–ú' or call.data == '–ü–æ–∫—Ä–æ–≤–∫–∞':
        user = User.objects.get(tg_id=call.from_user.id)
        user.campus = call.data
        user.save()
        keyboard = telebot.types.InlineKeyboardMarkup()
        key1 = telebot.types.InlineKeyboardButton(text='–ù–µ—Ç, –Ω—É–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –ª–æ–∫–∞—Ü–∏—é...', callback_data='–ò–∑–º–µ–Ω–∏—Ç—å –∫–æ—Ä–ø—É—Å')
        key2 = telebot.types.InlineKeyboardButton(text='–î–∞, –¥–∞–≤–∞–π –Ω–∞—á–Ω–µ–º!', callback_data='–ù–∞—á–∞—Ç—å')
        keyboard.add(key2)
        keyboard.add(key1)
        bot.send_message(call.message.chat.id, f"""–ò—Ç–∞–∫, –¥–∞–≤–∞–π –æ–±—ä–µ–¥–∏–Ω–∏–º —Ç–æ, —á—Ç–æ —è –æ —Ç–µ–±–µ —É–∑–Ω–∞–ª
–¢–µ–±—è –∑–æ–≤—É—Ç {user.name}
–¢–≤–æ—è —Ñ–∞–º–∏–ª–∏—è {user.surname}
–¢–≤–æ—è –ª–æ–∫–∞—Ü–∏—è {user.campus}

–í—Å—ë –≤–µ—Ä–Ω–æ?""", reply_markup=keyboard)
    elif call.data == '–ò–∑–º–µ–Ω–∏—Ç—å –∫–æ—Ä–ø—É—Å':
        keyboard = telebot.types.InlineKeyboardMarkup()
        key1 = telebot.types.InlineKeyboardButton(text='–ú–ò–≠–ú', callback_data='–ú–ò–≠–ú')
        keyboard.add(key1)
        key2 = telebot.types.InlineKeyboardButton(text='–ü–æ–∫—Ä–æ–≤–∫–∞', callback_data='–ü–æ–∫—Ä–æ–≤–∫–∞')
        keyboard.add(key2)
        bot.send_message(call.message.chat.id, text='–í—ã–±–µ—Ä–∏ –∫–æ—Ä–ø—É—Å', reply_markup=keyboard)
    elif call.data == '–ù–∞—á–∞—Ç—å' or call.data == '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å':
        user = User.objects.get(tg_id=call.from_user.id)
        question = Question.objects.get(number=(user.start-1+user.stage)%12+1)
        keyboard = telebot.types.ReplyKeyboardMarkup(True, True)
        keyboard.row('–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å')
        keyboard.row('–°—á—ë—Ç')
        if user.stage == 0:
            if user.campus == '–ú–ò–≠–ú':
                bot.send_message(call.message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å, {question.place_miem}  –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
            elif user.campus == '–ü–æ–∫—Ä–æ–≤–∫–∞':
                bot.send_message(call.message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å, {question.place_pokrovka} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
            elif user.campus == '–°—Ç–∞—Ä–∞—è –ë–∞—Å–º–∞–Ω–Ω–∞—è':
                bot.send_message(call.message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å, {question.place_basmach} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
        else:
            if user.campus == '–ú–ò–≠–ú':
                bot.send_message(call.message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å, {question.place_miem} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
            elif user.campus == '–ü–æ–∫—Ä–æ–≤–∫–∞':
                bot.send_message(call.message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å, {question.place_pokrovka} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
            elif user.campus == '–°—Ç–∞—Ä–∞—è –ë–∞—Å–º–∞–Ω–Ω–∞—è':
                bot.send_message(call.message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å, {question.place_basmach} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
        bot.register_next_step_handler(call.message, play)


def play(message: telebot.types.Message):
    user = User.objects.get(tg_id=message.from_user.id)
    question = Question.objects.get(number=(user.start-1+user.stage)%12+1)

    if message.text == '–°—á—ë—Ç':
        bot.send_message(message.chat.id, f'–¢–≤–æ–π —Å—á—ë—Ç –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç: {user.score}\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –≤–æ–ø—Ä–æ—Å–æ–≤: {12-user.stage}')
    elif message.text == '/stop':
        bot.send_message(message.chat.id, """–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –∫–≤–µ—Å—Ç–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.
–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
        return
    elif message.text == '–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å':
        user.stage += 1
        user.tries = 0
        user.save()
        user = User.objects.get(tg_id=message.from_user.id)
        question = Question.objects.get(number=(user.start-1+user.stage)%12+1)
        if user.stage >= 12:
            if int(user.wave) != int(Game.objects.all().values('wave')[0]['wave']):
                bot.send_message(message.chat.id, f"""–≠—Ç–æ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å, –∞ –∑–Ω–∞—á–∏—Ç –∫–≤–µ—Å—Ç –æ–∫–æ–Ω—á–µ–Ω
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Ç—ã –Ω–µ —É—Å–ø–µ–ª –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å–≤–æ–µ–π –≤–æ–ª–Ω—ã

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                return
            win = 10
            if user.score >= win:
                #–µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π —Å score>10 –Ω–∞ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ <= 8 –∏ –≤ –æ–¥–Ω—É –≤–æ–ª–Ω—É, —Ç–æ –≤—ã–∏–≥—Ä–∞–ª –∏–Ω–∞—á–µ –ø—Ä–∏–∑–æ–≤ –Ω–µ—Ç
                if len(User.objects.filter(score__gte=win, campus=user.campus, wave=user.wave)) <= 8:
                    bot.send_message(message.chat.id, f"""–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Ç–µ–±—è! –¢—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –º–æ–π –∫–≤–µ—Å—Ç
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ü–æ–¥—Ö–æ–¥–∏ –∑–∞ –ø—Ä–∏–∑–æ–º —Ç—É–¥–∞, –≥–¥–µ –≤—Å—ë –Ω–∞—á–∞–ª–æ—Å—å

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                    return
                else:
                    bot.send_message(message.chat.id, f"""–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Ç–µ–±—è! –¢—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –º–æ–π –∫–≤–µ—Å—Ç
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø—Ä–∏–∑—ã —É–∂–µ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                    return
            else:
                bot.send_message(message.chat.id, f"""–≠—Ç–æ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å, –∞ –∑–Ω–∞—á–∏—Ç –∫–≤–µ—Å—Ç –æ–∫–æ–Ω—á–µ–Ω
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∏–∑–∞

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                return
    elif message.text.lower() == question.answer.lower():
        user.score += 1
        user.stage += 1
        user.tries = 0
        user.save()
        user = User.objects.get(tg_id=message.from_user.id)
        question = Question.objects.get(number=(user.start-1+user.stage)%12+1)
        if user.stage >= 12:
            if int(user.wave) != int(Game.objects.all().values('wave')[0]['wave']):
                bot.send_message(message.chat.id, f"""–≠—Ç–æ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å, –∞ –∑–Ω–∞—á–∏—Ç –∫–≤–µ—Å—Ç –æ–∫–æ–Ω—á–µ–Ω
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Ç—ã –Ω–µ —É—Å–ø–µ–ª –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å–≤–æ–µ–π –≤–æ–ª–Ω—ã

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                return
            win = 10
            if user.score >= win:
                #–µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π —Å score>10 –Ω–∞ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ <= 8 –∏ –≤ –æ–¥–Ω—É –≤–æ–ª–Ω—É, —Ç–æ –≤—ã–∏–≥—Ä–∞–ª –∏–Ω–∞—á–µ –ø—Ä–∏–∑–æ–≤ –Ω–µ—Ç
                if len(User.objects.filter(score__gte=win, campus=user.campus, wave=user.wave)) <= 8:
                    bot.send_message(message.chat.id, f"""–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Ç–µ–±—è! –¢—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –º–æ–π –∫–≤–µ—Å—Ç
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ü–æ–¥—Ö–æ–¥–∏ –∑–∞ –ø—Ä–∏–∑–æ–º —Ç—É–¥–∞, –≥–¥–µ –≤—Å—ë –Ω–∞—á–∞–ª–æ—Å—å

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                    return
                else:
                    bot.send_message(message.chat.id, f"""–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Ç–µ–±—è! –¢—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –º–æ–π –∫–≤–µ—Å—Ç
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø—Ä–∏–∑—ã —É–∂–µ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                    return
            else:
                bot.send_message(message.chat.id, f"""–≠—Ç–æ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å, –∞ –∑–Ω–∞—á–∏—Ç –∫–≤–µ—Å—Ç –æ–∫–æ–Ω—á–µ–Ω
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∏–∑–∞

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                return
        bot.send_message(message.chat.id, f'–û—Ç–≤–µ—Ç –≤–µ—Ä–Ω—ã–π, –ø–æ–∑–¥—Ä–∞–≤–ª—è—é!')
    elif message.text.lower() != question.answer.lower() and message.text != '–ù–∞—á–∞—Ç—å':
        user.tries += 1
        user.save()
        user = User.objects.get(tg_id=message.from_user.id)
        if user.tries == 2:
            user.stage += 1
            user.tries = 0
            user.save()
            user = User.objects.get(tg_id=message.from_user.id)
            question = Question.objects.get(number=(user.start-1+user.stage)%12+1)
            if user.stage >= 12:
                if int(user.wave) != int(Game.objects.all().values('wave')[0]['wave']):
                    bot.send_message(message.chat.id, f"""–≠—Ç–æ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å, –∞ –∑–Ω–∞—á–∏—Ç –∫–≤–µ—Å—Ç –æ–∫–æ–Ω—á–µ–Ω
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Ç—ã –Ω–µ —É—Å–ø–µ–ª –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å–≤–æ–µ–π –≤–æ–ª–Ω—ã

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                    return
                win = 10
                if user.score >= win:
                    #–µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π —Å score>10 –Ω–∞ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ <= 8 –∏ –≤ –æ–¥–Ω—É –≤–æ–ª–Ω—É, —Ç–æ –≤—ã–∏–≥—Ä–∞–ª –∏–Ω–∞—á–µ –ø—Ä–∏–∑–æ–≤ –Ω–µ—Ç
                    if len(User.objects.filter(score__gte=win, campus=user.campus, wave=user.wave)) <= 8:
                        bot.send_message(message.chat.id, f"""–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Ç–µ–±—è! –¢—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –º–æ–π –∫–≤–µ—Å—Ç
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ü–æ–¥—Ö–æ–¥–∏ –∑–∞ –ø—Ä–∏–∑–æ–º —Ç—É–¥–∞, –≥–¥–µ –≤—Å—ë –Ω–∞—á–∞–ª–æ—Å—å

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                        return
                    else:
                        bot.send_message(message.chat.id, f"""–ü–æ–∑–¥—Ä–∞–≤–ª—è—é —Ç–µ–±—è! –¢—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –º–æ–π –∫–≤–µ—Å—Ç
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø—Ä–∏–∑—ã —É–∂–µ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                        return
                else:
                    bot.send_message(message.chat.id, f"""–≠—Ç–æ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å, –∞ –∑–Ω–∞—á–∏—Ç –∫–≤–µ—Å—Ç –æ–∫–æ–Ω—á–µ–Ω
–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {user.score}
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∏–∑–∞

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ —è –ø–æ–º–æ–≥ —Ç–µ–±–µ –ø–æ–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ –º–∏—Ä –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –∏ —Ç—ã —É–∑–Ω–∞–ª —á—Ç–æ-—Ç–æ –Ω–æ–≤–æ–µ

–ë—É–¥–µ–º –∂–¥–∞—Ç—å —Ç–µ–±—è –Ω–∞ —é–±–∏–ª–µ–π–Ω–æ–º –î–µ—Ç–µ–∫—Ç–∏–≤–µ –æ—Ç Movement "–ü—Ä–æ–µ–∫—Ç AI-13" 22 –∏–ª–∏ 23 –º–∞—è!
–ü–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–π—Ç–∏, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ: 
https://vk.com/wall-212137529_273""")
                    return
            bot.send_message(message.chat.id, f'–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç —Ç–æ–∂–µ –Ω–µ–≤–µ—Ä–Ω—ã–π...')
        elif user.tries == 1:
            bot.send_message(message.chat.id, f'–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –æ—Ç–≤–µ—Ç –Ω–µ–≤–µ—Ä–Ω—ã–π\n–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑!')
    
    keyboard = telebot.types.ReplyKeyboardMarkup(True, True)
    keyboard.row('–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å')
    keyboard.row('–°—á—ë—Ç')

    if user.stage == 0:
        if user.campus == '–ú–ò–≠–ú':
            bot.send_message(message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å, {question.place_miem} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
        elif user.campus == '–ü–æ–∫—Ä–æ–≤–∫–∞':
            bot.send_message(message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å, {question.place_pokrovka} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
        elif user.campus == '–°—Ç–∞—Ä–∞—è –ë–∞—Å–º–∞–Ω–Ω–∞—è':
            bot.send_message(message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å, {question.place_basmach} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
    else:
        if user.campus == '–ú–ò–≠–ú':
            bot.send_message(message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å, {question.place_miem} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
        elif user.campus == '–ü–æ–∫—Ä–æ–≤–∫–∞':
            bot.send_message(message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å, {question.place_pokrovka} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
        elif user.campus == '–°—Ç–∞—Ä–∞—è –ë–∞—Å–º–∞–Ω–Ω–∞—è':
            bot.send_message(message.chat.id, f'–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å, {question.place_basmach} –∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ', reply_markup=keyboard)
    bot.register_next_step_handler(message, play)